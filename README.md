# PJT-10 FINAL
django REST API와 Vue.js를 활용한 영화 추천 및 커뮤니티
- Notion 
[https://www.notion.so/a10dd029a0a344e287360d3ee020190a?pvs=4]
- git
[https://github.com/poow810/movie_project]
- Server URL
[https://664f4e70e13f97036ba07b1d--reliable-cendol-bcf2d3.netlify.app/]
## SITE NAME
- PK=PK
- Park & Kim 혹은 Personal Key.. 개인에게 알맞은 영화 추천사이트!

## 팀원
- 김진우
  - Front-End
  - 프로젝트 전체 레이아웃 설계 + IA
  - API를 활용한 추천 알고리즘 아이디어 구상
  - 페이지 디자인


- 박하운
  - Back-End
  - 데이터 베이스 모델링 + ERD
  - 데이터 기반 추천 알고리즘 구상 및 구현
  - 서버 구축 및 개발환경 구축
  


## 목표 설계
- API를 활용한 영화 추천 서비스
  - openweather, geolocation, TMDB, Youtube API, Open API 활용
- 익명 커뮤니티 서비스
- 사용자 입장의 서비스 구현
- HTML, CSS, JavaScript, Bootstrap, Django, Vue, Rest API, DataBase 를 활용한 서비스 설계

- 기능
  - 장르별 추천 (장르별 TOP유저)
  - 실시간 조회수 순위 조회
  - 회원가입, 로그인, 로그아웃 등 Authenticaten 서비스 구현
  - 홈 페이지: 영화 리스트, 영화 상세페이지 구현
  - 회원 프로필: 선호 장르 선택, 남긴 리뷰, 댓글, 팔로우, 팔로워

## 설치
- python
```
python -m venv venv
source venv/script/activate
pip install -r requirements.txt
```

- vue
```
npm create vue@latest
npm install

npm install axios
npm install vuex-plugin-persistedstate
npm install pinia-plugin-persist
npm install bootstrap bootstrap-icons swiper

npm run dev
```

# 프로젝트 개요
## IA (Information Architecture)
![image1](https://github.com/poow810/movie_project/assets/111109429/860d664d-76a9-4775-bf9c-8869e9f003de)
## ERD
![ERD](https://github.com/poow810/movie_project/assets/111109429/6fa0da54-6604-4d4d-a002-419709797c68)
![ERD2](https://github.com/poow810/movie_project/assets/111109429/3e6013c6-d4e0-4b8f-a66b-dd2d74a1884e)

- MySQL 활용
  - 영화 데이터가 대규모인 만큼 쿼리 처리 성능이 중요한데, MySQL은 타 RDBMS보다 속도 성능이 우세함. <br>
MySQL은 사용자가 많은 만큼 커뮤니티가 활성화됨으로써 Database 관련 에러를 겪었을 때, 참고할 수 있는 자료가 많음 <br>
Workbench와 같은 도구를 통해 복잡한 쿼리문 대신 손쉽게 데이터에 접근, 제어가 가능함.

## 추천 알고리즘
- 1. 영화 제목 이외에 배우와 감독으로 검색이 가능하도록 설계.
  - TMDB API를 통해 받은 데이터에는 이름이 영어인 경우가 대부분
    - OpenAI API를 통해, 해당 데이터 transfer 및 DB에 저장하는 작업(데이터 전처리)
- 2. 검색 알고리즘, 날씨 기반 추천 알고리즘 설계
  - 검색 알고리즘 -> 영화, 이름으로 type을 구분. 각각의 model에서 필터링 -> 10개 미만의 데이터가 수집됐다면, 첫 번째 영화의 장르를 기준으로 combination -> 장르 조합을 만족하는 영화를 추가적으로 수집. 이 때, 가중치를 주어 장르 조합을 많이 만족하는 순서로 데이터를 수집하도록 설계. 영화 별 장르는 최대 4개를 초과하지 않기 때문에 최악의 경우에도 O(N^2^4*(쿼리평균수행시간))으로 볼 수 있음. -> 인덱싱을 통한 쿼리문 개선이 필요함
  - 날씨 추천 알고리즘 -> openweatherapi를 통한 날씨 데이터 수집 -> openai api에게 날씨 기반 장르 추천 데이터 수집. 장르를 파싱하여 해당 장르를 가진 영화들 중 랜덤하게 하나를 사용자에게 추천
![image-9](https://github.com/poow810/movie_project/assets/111109429/1c587561-5a8c-4dd3-9343-9d90893e18b0)


## AI 활용 기술
- 정규 표현식을 통한 장르 파싱
  - 해당 장르에 해당하는 영화 데이터 랜덤 추출

# 기능 및 구현
## 1. Navbar : 네비게이션 바
- 반응형 홈페이지
- 네비게이션 기능 구현
- 검색기능 구현
- 로그아웃 기능 구현

## 2. Login : 로그인
- 반응형 인풋 컴포넌트
- 로그인시 홈페이지로 라우팅
- 유효성 검증을 통한 사용성 개선
- 회원가입 버튼 클릭 시 회원가입 페이지로 라우팅

## 3. Signup : 회원가입
- 반응형 인풋 컴포넌트
- 유효성 검증을 통한 사용성 개선
- 회원가입 시 홈 페이지로 라우팅

## 4. Profile : 프로필
- Modal을 통한 프로필 이미지 변경
- 닉네임 변경기능
- M:N Model 을 통한 유저 팔로잉, 팔로워 기능
- view counting 기능
- like, article, comment 조회기능

## 5. Home : 홈
- youtube API를 통한 실시간 인기영화 top1 트레일러 자동재생
- tmdb API를 활용하여 상영중인 영화, 평점이 높은 영화 구현
- 평점 순 정렬 및 스와이프 기능
- tmdb API를 활용하여 장르 선택 기능 비동기처리

## 6. Community : 커뮤니티
- 게시판 형태의 커뮤니티 구현
- 인기글 필터링 ( 좋아요 > 조회순 가중치 적용 )
  - 글 세부 페이지 구현
  - 자신의 게시글 수정 및 삭제 기능
  - 댓글 작성 및 수정, 삭제 기능
- 페이지네이션 구현
- 새 글 작성 클릭시 작성페이지로 이동
- 아이디 클릭 시 프로필 페이지로 라우팅

## 7. Recommend : 추천
- 영화 추천을 위한 장르 선택 ( 최소값을 적용하여 복합추천 )
- 쿼리문을 통한 필터링
- DB기반 인기도 순, 평점 순 영화목록 구현
- 재추천 기능
- 알고리즘 추천 영화 상세페이지 구현
  - like 기능 추가 (프로필에 반영)
  - 리뷰 기능 추가 (프로필에 반영)
    - 리뷰 작성 구현
  - 리뷰 상세페이지 구현
    - 별점 추가 기능

## 8. Search : 검색
- 옵션을 이용하여 검색 타입 설정
- 상단에 검색결과와 같거나 가장 비슷한 결과 노출
- 영화 선택 시
  - DB에서 같거나 비슷한 이름의 영화 서치기능
    - 영화 상세페이지 라우팅
- 이름 선택 시
  - DB에서 같거나 비슷한 이름의 배우 서치
- 결과값 none 페이지 구현

## 9. 사용성 개선
- 회원가입, 로그인, 검색 기능에 유효성 검증 기능 추가
- 페이지 렌더링 시 데이터 패치 전 로딩 화면 구현
<br><br><br>

# 느낀 점
- 박하운
  - 모델 설계 - 모델 설계가 모든 단계의 최우선이라고 생각하여 최대한 신경써서 구현했지만,프로젝트 마지막에 오다보니 필드 하나가 설정이 잘못되어 있는 것을 깨달았다. 백엔드에서는 모델 설계와 그에 따른 시리얼라이저를 적절하게 사용해서, 클라이언트가 원하는 데이터를 제대로 넘겨주는 것이 중요하다는 것을 깨달았고, 하나의 모델을 만들고 해당 데이터를 반환하는 뷰를 만들 때마다 타입과 반환값을 잘 적어두어야겠다는 생각이 들었다. 이번 프로젝트에서 기능을 구현하면서 가장 어려웠던 점은 쿼리문을 통한 데이터 수집 알고리즘 설계와 프론트엔드 비동기 처리였다. 백엔드의 에러와 서버 상태 등 여러 요인들을 생각하여 페이지를 최대한 자연스럽게 사용자에게 보여주기 위해 여러 방법을 시도해보았던 것 같다. 현재는 로딩중 이미지를 통해 데이터 요청을 통해 새로운 데이터를 받기 전까지 로딩 처리를 했지만, 후에는 store와 axios 요청의 적절한 조화를 통해 프론트엔드 서버를 최적화하고 정말 자연스러운 페이지를 구현해보고 싶다.

  - 두 명이서 하는 프로젝트는 처음이었는데, 굉장히 좋은 경험이라고 생각한다. 전체 프로젝트 구상부터 역할 분담 등 모든 작업을 해내야만했다. 단순히 프론트엔드, 백엔드로 역할을 나눠서 하면 되겠지라는 생각을 바꾸게 된 프로젝트였다. 일과를 마무리하며 프로젝트 진행사항도 관리해야했고, 항상 깃허브를 통한 형상 관리, 결과물 작성까지 직접 코드를 작성하지 않아도 해야할 일들이 많은 프로젝트였다. 팀장님이 잘 관리해주셨기 때문에 프로젝트가 성공적으로 마무리되었다고 생각한다. 협업을 하며 부족한 점도 많았지만, 서로 부족한 점을 채워주며 프로젝트 완성을 위해 노력했기에 완성했다고 생각한다.

- 김진우
  - 첫 개발 프로젝트
    - 개발 첫 프로젝트인만큼 잘하고싶다는 긴장과 기대 불안 여러가지 마음을 갖고 시작했다. 백과 프론트를 나누고 회의를 통해 IA설계와 ERD설계를 순조롭게 이어가면서 백 모델설계까지 순조로웠는데 프론트를 구축하는 과정에서 데이터를 읽고 처리하는 과정이 어려웠던 것 같다. 역할은 나눠져있지만 프론트와 백이 서로를 잘 이해하고 있어야 원활한 데이터 소통이 가능하다는 걸 느꼈다. 
  - 설계의 중요성
    - 시작은 순조로웠지만 개발이 진행될수록 설계의 중요성을 느꼈다. 일주일이라는 짧은 시간 속에서 구현할 기능과 레이아웃을 정의하고 해당 기능들의 우선순위까지 구분해야 허비되는 시간없이 개발기간을 최대한 아낄 수 있었을 것 같다. 명세에 있는 대부분의 기능을 구현했지만 개발할수록 욕심이 생겨서 다른길로 새는일이 많았다고 생각하기 때문에 이 점을 앞으로는 유의해야겠다.
  - 형상관리
    - 첫 프로젝트인만큼 Git으로 서로의 데이터를 주고받았다. 각자의 영역에서 작업할때는 큰 문제가 없었지만, 서버 구현이 끝나고 프론트 영역에서 함께 데이터를 주고받다보니 충돌이 생기기도 했다. 해결한 경우와 그렇지 못한경우가 함께 있었기 때문에 형상관리의 중요성을 크게 느끼게 된 계기가 된 것 같다.
  - 팀이라는건
    - 솔직히 팀원에 비해 많이 부족했다고 생각한다. 그래도 내가 할 수 있는 일을 최대한 하고자 했고, 속도는 느리지만 그동안 배웠던 지식으로 서버에서 들어오는 데이터의 처리, 비동기, 스타일링 등 웹에서 구현할 수 있는 부분을 최대한 해본 것 같다. 노력해도 부족했던 부분에 대해서, 정말 잘하는 팀원과 함께했기 때문에 도움을 많이 받은 것 같다. 서버구축과 백 데이터 연동, 그리고 구현하기 힘들었던 데이터의 프론트 반영까지 정말 많은 부분에 대해 도움을 주고 힘들때마다 포기하지 말라고 격려해주던 프로젝트에 진심인 팀원에게 고맙다고 전하고싶다.
<br><br><br>

# 날짜별 진행
### 240516
> 해야할 일
1. 기획 및 컨셉 설계
2. 페이지 구성 설계
3. 목표 설정
---
- BE: 박하운
  - 배포서버 구축
  - ERD 모델링
  - 회원가입 기능 추가
  - 로그인 기능 추가

- FE : 김진우
  - 로그인
  - 회원가입
  - IA 설계(05.16)
  - 웹페이지 레이아웃 설계

### 240517
> 해야할 일
1. ERD설계
2. 뷰 / 컴포넌트 만들기 
3. nav: 커뮤니티 / 영화 / 유저 
4. compo: 게시글, 댓글 / 영화리스트 / 좋아요, 좋아요 한 영화 목록, 평점, 팔로우
---
- BE: 박하운
  - User model Custom
  - 프로필 조회 기능 구현
  - Community 모델 설계
  - Movie 모델 설계
  - Community CRUD 구현
  - 기본 base로 사용할 Movie data를 TMDB API 요청을 통해 추출
- FE: 김진우
  - youtube 미리보기 추가
  - HomeView 컴포넌트 추가 (홈, 커뮤니티, 로그인, 로그아웃)
  - 회원가입 커스텀 속성추가 (email, nickname)
  - 커뮤니티 글쓰기 기능 추가
  - 로그아웃 기능 추가

### 240518
> 해야할 일
1. ERD 수정
2. 홈 화면 데이터 출력 방식
3. Movie 데이터 전처리
4. 커뮤니티 공지 기능을 추가하기 위해 token에서 사용자 정보를 추출해야함
→ 장고에서 제공하는 allauth 라이브러리로 생성한 토큰은 사용자 정보를 갖고 있지 않은 단순 인증을 위한 토큰임.
→ 기능 삭제
5. top 리뷰어 정보를 어떻게 수신할지
→ setinterval을 통한 반복적 요청(단일 데이터 하나만 가져오는 것이기 때문에 메모리 크게 상관 없음)
---
- BE: 박하운
  - OPENAI API를 통해 TMDB 영화 데이터 전처리
  - 장르별 조회 기능 구현
  - Movie 모델 다대다 관계 구현
  - 백엔드 서버 배포 완료

- FE: 김진우
  - IA 설계 수정
  - 홈 평점순 영화 추가
  - 홈 장르 리스트 추가
  - 선호 장르 선택 기능 추가

### 240519
> 해야할 일
1. 로컬 스토리지를 비우고 새로 로그인했을 때, 네비게이션 바가 없어지는 이슈.
2. 영화추천 선택 후, 새로고침하면 다시 선택해야하는 이슈 (피냐가 작동을 안함?)
---
- BE: 박하운
  - 프로필 이미지 변경 기능 추가
  - 사용자 닉네임 변경 기능 추가
  - 유저 팔로우, 팔로잉 기능 추가
  
- FE: 김진우
  - 선호장르 선택기능 추가
  - 장르선택 여부에 따른 반응형 라우터 추가
  - 토큰 비동기 fix
  - 레이아웃 설계

### 240520
- BE: 박하운
  - 영화 상세 조회, 좋아요 기능 구현
  - 커뮤니티 좋아요 기능 구현
  - 커뮤니티 댓글 기능 구현
  - 영화 리뷰 기능 구현

- FE: 김진우
  - 홈 화면 최신 영화 API로 수정 구현
  - css 시작

### 240521
> 해야할 것
1. 회원가입처리 (username => 값이 없을 때 처리, 값이 있는 경우에는 들어가서 확인 후 처리. 에러 확인 후 캐치구문에서 추출후 구현.)
2. 좋아요 기능 수정 (카운트가 6씩 올라감)
3. 검색했을때 10개 미만이면 장르 가중치를 매겨서 같은 장르가 많을수록 먼저 출력
---
- BE: 박하운
  - 영화 디테일 페이지 컴포넌트 수정
  - 프로필에서 내가 좋아요한 영화, 내 게시글, 내 리뷰 볼 수 있도록 수정
  - 프로필에서 해당 페이지로 이동할 수 있도록 수정
  - 좋아요, 팔로우 기능 오류 수정
  - MySQL db 테이블 구성 및 데이터 생성
  - 날씨 기반 추천 알고리즘 구현
- FE: 김진우
  - 홈페이지 화면 수정
  - 홈페이지 영화장르선택 기능 추가
  - 헤더 네비게이션 css
  - 커뮤니티 게시판 css
  - 영화추천 페이지 css

### 240522
> 해야할 것
1. 검색어를 포함한 영화 이외에 추가 데이터를 필터링할 때, 기준이 장르인데 이 기준을 정하는 것이 기존 검색어를 포함한 영화들 중 가장 먼저 뽑힌 영화를 기준으로 하는 것
2. 좋아요 기능 비동기처리
3. 좋아요 기능 상대방 반영
4. 영화 리뷰가 다른 유저에게 안보이는 오류 수정
5. 검색 데이터가 아예 없다면 오류 처리
6. 댓글사진 눌렀을 때 프로필 페이지로
7. 홈의 영화 이미지 누르면 디테일 페이지로
8. 영화 디테일페이지, 리뷰페이지 css
9. 커뮤니티 옵션 필터링
10. 검색 했을때 데이터 보여주기
11. ERD 수정

- BE-박하운
  - 깃허브 파일 오류로 인한 서버 재배포
  - 댓글이 다른 유저에게 안보이는 오류 수정
- FE-김진우
  - 홈페이지 css
  - 로그인페이지, 회원가입페이지, 커뮤니티 페이지 css
  - 네비게이션바 반응형 수정

### 240523
> 해야할 것
1. 로그인창 회원가입 라우터푸시
2. 배우네비바 없애기
3. 커뮤니티 글쓰기 css
4. 날씨 알고리즘 + css
5. 리뷰상세 css
6. 검색 시 유효성 검증
7. 페이지 로딩 시 비동기 처리
8. 리뷰 상세 페이지 조회css

- BE: 박하운
  - 페이지 로딩 시 이전 데이터 보이지 않도록 수정
  - 날씨 기반 영화 추천 알고리즘 설계
- FE: 김진우
  - 커뮤니티, 날씨 페이지 css
  - 로그인창 기능수정
